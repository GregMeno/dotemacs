((section 2 "chickadee" (p (i "chickadee") " is a web interface to " (tt "chicken-doc") ".") (section 3 "Quickstart" (pre "# chicken-install chickadee\n$ chickadee serve") (p "This will start a chickadee server on " (link "http://localhost:8080") ", using your global chicken-doc repository.") (toc)) (section 3 "Setting up a server" (p "Before using " (i "chickadee") ", you need to download or create a " (int-link "chicken-doc") " repository.  Next, fetch " (i "chickadee") " using " (tt "chicken-install") ":") (pre "# chicken-install chickadee") (p "This installs the chickadee library files, static web files, configuration files and a helper program called " (tt "chickadee") " which simplifies running your own server.") (p "chickadee is usually ready to run without further configuration:") (pre "$ chickadee serve") (p "This starts a server on port 8080, using the default configuration and data files that were installed via " (tt "chicken-install") ".  Access, debug and AJAX logs are disabled, and error logging is sent to " (i "stderr") ".  Therefore no special privileges are required to start the default config.") (p "You may sometimes need to customize the server settings -- for example to start on a different port.  This is explained below.") (section 4 "Customization at the command-line" (p "The " (tt "chickadee") " wrapper accepts options which override commonly-changed settings in the configuration file, so that you don't need to modify the config file for simple changes.") (pre "usage: chickadee serve [options] [conf-file]\noptions:\n\n  -p --port NUM         Port number\n\n  -A --access-log FILE  Access log file\n  -E --error-log FILE   Error log file\n  -D --debug-log FILE   Debug log file\n  -J --ajax-log FILE    AJAX access log\n    FILE is a filename relative to the directory holding [conf-file].\n    It may be \"-\" to log to the console or \"\" to suppress logging.") (pre "examples:\n  chickadee serve -p 8081\n    Start a server on port 8081.\n  chickadee serve -A - -D /tmp/debug.log -J /tmp/ajax.log -E \"\"\n    Log accesses to stdout, debugging information to /tmp/debug.log,\n    and AJAX accesses to /tmp/ajax.log.  Error logging is suppressed.")) (section 4 "Customization of the configuration file" (p "For permanent or complex configuration changes, the default configuration file can be modified, or the " (tt "chickadee") " wrapper can be directed to use an alternate config file.  Keep in mind that the defaults will be overwritten whenever the egg is upgraded.") (p "You can find the location of the default chickadee config file with:") (pre "$ chickadee location\nconf: /usr/local/chicken-4/share/chicken/chickadee/config.scm\nbase: /usr/local/chicken-4/share/chicken/chickadee") (p (tt "conf") " is the configuration file and " (tt "base") " is the base directory containing all chickadee's datafiles.  At startup, chickadee changes to the " (tt "base") " directory, and so all paths in the config file are relative to that location.") (p "Actually, " (tt "base") " is always the directory containing " (tt "conf") ", so you can copy the default base directory tree anywhere, point chickadee to that config file, and that copy will be used.") (pre "$ cp -rp /usr/local/chicken-4/share/chicken/chickadee ~\n$ chickadee serve ~/chickadee/config.scm") (p "You can also place multiple config files inside the same base directory, sharing the same datafiles with different configurations:") (pre "$ cp ~/chickadee/config.scm ~/chickadee/config-prod.scm\n$ vi ~/chickadee/config-prod.scm\n$ chickadee serve ~/chickadee/config-prod.scm") (p "The actual path to chickadee's datafiles is controlled by the configuration options " (tt "root-path") ", " (tt "access-log") " and so on, which by default use relative paths (to the location of the config file). You can use absolute paths instead if you like; the \"base directory\" is just a matter of convenience.") (p "Configuration " (int-link "#Configuration" "syntax") " and " (int-link "#Examples" "examples") " are described later in this document.")) (section 4 "Customization of look and feel" (p "The CSS and Javascript static files can be modified to customize the look and feel of chickadee.  The recommended way to do this is to " (int-link "#Customization of the configuration file" "make a copy") " of the chickadee base directory first.  A further suggestion is to rename (or copy) the files you want to change and then update their paths in the configuration file:") (pre "$ cp ~/chickadee/root/cdoc/chickadee.css \\\n     ~/chickadee/root/cdoc/chickadee-mine.css ") (pre "# then in ~/chickadee/config.scm, change\n(chickadee-css-files (list (uri \"/cdoc/chickadee.css\")))\n# to\n(chickadee-css-files (list (uri \"/cdoc/chickadee-mine.css\")))") (p "Finally you might even want to change the configuration file name:") (pre "$ mv ~/chickadee/config.scm ~/chickadee/config-mine.scm") (p "The rationale behind this is to allow you to copy datafile updates from the egg into your private copy without clobbering your changes. (A better solution to initialize and update a copy might be provided in the future.)") (p "Currently the page layout, and especially the root page, are not customizable without editing the source code."))) (section 3 "API" (def (sig (procedure "(chickadee-start-server)" (id chickadee-start-server))) (p "Start the Chickadee server.  Server configuration is done via parameters and, as " (int-link "spiffy") " is used as the backend webserver, all of its configuration options also apply."))) (section 3 "Configuration" (def (sig (parameter "chickadee-uri" (id chickadee-uri))) (p "Main access URI to Chickadee for users, as a URI object.") (p "Defaults to " (tt "(uri-reference \"/chickadee\")") ", so that the node " (tt "foreign types") " is accessible at " (tt "/chickadee/foreign/types") ".")) (def (sig (parameter "cdoc-uri" (id cdoc-uri))) (p "Internal URI for Chickadee, used to perform path and identifier lookup and searches.") (p "Although you can choose to make " (tt "cdoc-uri") " a child of " (tt "chickadee-uri") ", keep in mind it may conflict with an existing node name.") (p "Defaults to " (tt "(uri-reference \"/cdoc\")") ".")) (def (sig (parameter "incremental-search-uri" (id incremental-search-uri))) (p "URI used to provide incremental search capability.  This URI is arbitrary, but is typically a child of " (tt "cdoc-uri") ".  Due to AJAX limitations it must inhabit the same domain name as " (tt "chickadee-uri") ".") (p "Defaults to " (tt "(uri-reference \"/cdoc/ajax/prefix\")") ".")) (def (sig (parameter "chickadee-css-files" (id chickadee-css-files))) (p "List of URIs to CSS files for Chickadee.") (p "Defaults to " (tt "(list (uri-reference \"/cdoc/chickadee.css\"))") ".")) (def (sig (parameter "chickadee-js-files" (id chickadee-js-files))) (p "List of URIs to Javascript files for Chickadee.") (p "Defaults to " (tt "(list (uri-reference \"/cdoc/chickadee.js\"))") ".")) (def (sig (parameter "maximum-match-results" (id maximum-match-results))) (p "Maximum number of match results to return for a match query. Default: 250.")) (def (sig (parameter "maximum-match-signatures" (id maximum-match-signatures))) (p "Maximum number of signatures to return for a match query, up to " (tt "maximum-match-results") ".  Default: 100.  Obtaining signatures may increase disk load in the current implementation.")) (def (sig (parameter "incremental-search" (id incremental-search))) (p "Number of incremental search results to display; 0 or #f to disable. Defaults to 0.")) (def (sig (parameter "incremental-search-delay" (id incremental-search-delay))) (p "Time in milliseconds to delay incremental search requests.  Defaults to 50, which seems reasonable for WAN or LAN use.  20 will give even better interactive response on a fast network and CPU.")) (def (sig (parameter "cache-nodes-for" (id cache-nodes-for))) (p "Time in milliseconds to inform browsers that node pages should be cached for.  Defaults to 300.  If #f, no caching is done.")) (def (sig (parameter "cache-static-content-for" (id cache-static-content-for))) (p "Time in milliseconds to inform browsers that static content such as CSS and Javascript should be cached for.")) (def (sig (parameter "last-modified" (id last-modified))) (p "Base time used for node last-modified calculations, in seconds.") (p "Chickadee uses the overall repository modification time (updated whenever a reindex is done) to determine when a node was last modified.  Browsers with a vaild cached copy will receive a \"304 Not Modified\" response.") (p "However, the value of " (tt "last-modified") " will also be considered; the modification time is taken as the maximum of the two values.  This is done because changes to program logic may change the rendering of the page even when the repository has not changed.  For example, set " (tt "last-modified") " to " (tt "(current-seconds)") " to simply invalidate all pages when the server is restarted.") (p "Defaults to 0.")) (def (sig (parameter "ajax-log" (id ajax-log))) (p "AJAX access log pathname.  Separate from the usual " (tt "access-log") " because this is potentially disk and CPU intensive.  Set to " (tt "#f") " to disable."))) (section 3 "Debugging" (def (sig (parameter "%chickadee:debug-incremental-search-latency" (id %chickadee:debug-incremental-search-latency))) (p "Simulate network latency of N milliseconds for incremental search. Allows you to test estimated interactive response across the Internet on a local system."))) (section 3 "Examples" (section 4 "Configuration examples" (p "An example local configuration file for the " (tt "chickadee") " wrapper.  If you add (chickadee-start-server) to the end, you can run this file as a standalone program.") (highlight scheme "(use chickadee spiffy uri-common)\n(define uri uri-reference)\n(root-path \"root\")\n(debug-log (current-error-port))\n(server-port 8080)\n(access-log \"logs/access.log\")\n(max-connections 8)\n(ajax-log \"/tmp/ajax.log\")\n(cdoc-uri (uri \"/cdoc\"))\n(chickadee-uri (uri \"/chickadee\"))\n(incremental-search-uri (uri \"/cdoc/ajax/prefix\"))\n(chickadee-css-files (list (uri \"/cdoc/chickadee.css\")))\n(chickadee-js-files\n (list (uri \"http://code.jquery.com/jquery-1.4.2.min.js\")\n       (uri \"/cdoc/jquery.metadata.2.1.min.js\")\n       (uri \"/cdoc/chickadee-jquery.js\")))\n(maximum-match-results 250)\n(maximum-match-signatures 100)\n(incremental-search 15)\n(incremental-search-delay 50)\n(cache-nodes-for 300)\n(cache-static-content-for 1800)\n(last-modified (current-seconds))") (p "Configuration of " (link "http://3e8.org/chickadee" "primary chickadee server") " running on 3e8.org behind an nginx caching proxy.") (highlight scheme "(use chickadee spiffy uri-common)\n(define uri uri-reference)\n(root-path \"root\")\n(debug-log (current-error-port))\n(access-log \"logs/access.log\")\n(error-log \"logs/error.log\")\n(server-port 8383)\n(max-connections 8)\n(ajax-log #f)\n(cdoc-uri (uri \"/cdoc\"))\n(chickadee-uri (uri \"/chickadee\"))\n(incremental-search-uri (uri \"/cdoc/ajax/prefix\"))\n(chickadee-css-files (list (uri \"/cdoc/chickadee.css?5\")))\n(chickadee-js-files\n (list (uri \"http://code.jquery.com/jquery-1.4.2.min.js\")\n       (uri \"/cdoc/jquery.metadata.2.1.min.js\")\n       (uri \"/cdoc/chickadee-jquery.js?2\")))\n(maximum-match-results 250)\n(maximum-match-signatures 100)\n(incremental-search 15)\n(incremental-search-delay 50)\n(cache-nodes-for 600)\n(cache-static-content-for 1800)\n(last-modified (current-seconds))\n(chickadee-start-server)")) (section 4 "Usage examples" (ul (li (link "http://conkeror.org/Webjumps#Chickadee" "Webjump for Conkeror"))))) (section 3 "git repository" (p "The official code is part of the Chicken SVN repository, but the author's git repository is available at http://3e8.org/pub/git/chickadee.git/.")) (section 3 "About this egg" (section 4 "Author" (p "Jim Ursetto")) (section 4 "Version history" (dl (dt "0.9.0") (dd "Initial release.") (dt "0.9.8") (dd "Add chickadee wrapper."))) (section 4 "License" (p "Copyright (c) 2010 Jim Ursetto.  License: 3-clause BSD.")))))