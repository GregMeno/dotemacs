((section 2 "osxattr" (p "Batch split and join HFS+ extended attributes.") (section 3 "Overview" (p (i "osxattr") " provides a command-line program to split HFS+ extended attributes from filesystem objects into a self-contained format, and a program to rejoin these split attributes.  Because the attributes are split into simple files, it is possible to back them up with rsync or other standard backup tools and store them on filesystems without knowledge of EAs.  This is the approach espoused by the " (link "http://www.shoup.net/xbup/" "xbup") " utility, which inspired this egg.") (p "The extended attribute format is either the standard AppleDouble format which can be read by Apple's own utilities (including NFS), or a special SXML format designed for " (i "osxattr") ".")) (section 3 "split-xattr" (pre "usage: ./split-xattr [options] [file-base] [xattr-base]\n     --attr-mode=FMT        attribute output mode [default: dedicated]\n     --list-format=FMT      format of input file list [default: rsync-list-only]\n     --no-specials          skip fifos and sockets\n     --no-symlinks          skip symlinks (recommended for copyfile on 10.4)\n -n, --dry-run              describe operations only\n -v, --verbose              verbose progress report\n -h, --help                 usage information\n -V, --version              version information") (p "Reads HFS+ metadata from a list of files given on stdin and outputs it to one or many files, depending on the selected output format. Input filenames are relative to " (tt "file-base") " (i.e. we chdir to " (tt "file-base") " at startup), which defaults to the current directory.  " (tt "xattr-base") " is prefixed to output filenames, and defaults to empty; by setting it, one may output to a parallel directory structure.") (p "Note that the " (i "split") " operation does not delete any attributes from the files; it just copies them to the output.") (p "The attribute output mode (" (tt "--attr-mode") ") may be one of the following:") (dl (dt "individual") (dd "EAs from " (tt "filename") " are written in SXML format to " (tt "._@filename") ".") (dt "dedicated") (dd "EAs from " (tt "filename") " are written in SXML format to " (tt ".@@/._@filename") ".  That is, a dedicated directory " (tt ".@@") " under the parent of " (tt "filename") ".") (dt "unified") (dd "One record for each input file is written to stdout.  (" (b "Warning") ": this method cannot currently be decoded by " (tt "join-xattr") ".)") (dt "appledouble") (dd "Copy Finder Info and the Resource Fork to " (tt "._filename") " in AppleDouble v2 format, using our own packing routines.  Other extended attributes are (currently) not copied.") (dt "copyfile") (dd "Copy " (i "all") " HFS+ metadata to " (tt "._filename") " using the native OS X AppleDouble packer.  This may not be 100% reliable on OS X 10.4, but works fine on 10.5.  In particular, add " (tt "--no-symlinks") " when on 10.4.")) (p "The input file list format (" (tt "--list-format") ") may be one of the following:") (dl (dt "rsync-list-only") (dd "the output of " (tt "rsync --list-only") ".  Useful for rsync backups, because you can run the same command to obtain a list of files and then again to actually back them up.") (dt "find") (dd "the output of " (tt "find -print")) (dt "find0") (dd "the output of " (tt "find -print0")))) (section 3 "join-xattr" (pre "usage: ./join-xattr [options] [file-base] [xattr-base]\n     --attr-mode=MODE       attribute input mode [default: dedicated]\n     --list-format=FMT      format of input file list [default: rsync-list-only]\n     --no-specials          skip fifos and sockets\n     --no-symlinks          skip symlinks (recommended for copyfile on 10.4)\n -n, --dry-run              describe operations only\n -v, --verbose              verbose progress report\n -h, --help                 usage information\n -V, --version              version information") (p "Reads a list of files given on stdin and applies the corresponding serialized HFS+ metadata to each.  Input filenames have any leading / stripped and are relative to " (tt "file-base") " (i.e. we chdir to " (tt "file-base") " at startup); " (tt "file-base") " defaults to the current directory.  " (tt "xattr-base") " is prefixed to attribute filenames, and defaults to empty; by setting it, one may apply attributes from a parallel directory structure.") (p "The possible values for the attribute output file format (" (tt "--attr-mode") ") and input file list format (" (tt "--list-format") ") are the same as for " (tt "split-xattr") ".  However, note that " (tt "unified") " attribute mode is not currently supported.")) (section 3 "Examples" (section 4 "Split attributes into .@@/ directories for entire disk" (p "For every directory PATH on the disk, create a directory " (tt "PATH/.@@") " and split attributes from " (tt "PATH/FILE") " into " (tt "PATH/.@@/._@FILE") ", in SXML format.") (pre "rsync -a --list-only --filter '- .@@' --relative / |    \\\nsplit-xattr --verbose --list-format=rsync-list-only     \\\n      --attr-mode=dedicated --no-specials               \\\n      /") (p "For example, the attributes of " (tt "/Users/me/myfile") " are written in SXML to " (tt "/Users/me/.@@/._@myfile") ".")) (section 4 "Split attributes into ._ files in parallel tree for entire disk" (p "For every directory PATH on the disk, split attributes from " (tt "PATH/FILE") " into " (tt "/._./PATH/._FILE") ".") (pre "rsync -a --list-only --filter='- ._*' --relative / |    \\\nsplit-xattr --verbose --list-format=rsync-list-only     \\\n      --attr-mode=copyfile --no-symlinks --no-specials  \\\n      /  /._.") (p "The " (tt "xattr-base") " option " (tt "/._.") " is prepended to every output path, which creates a parallel directory tree that can be backed up and disposed of (for example, " (tt "/._.") " could be a ramdisk).  If the base option were not provided, attribute files would be written directly inline to " (tt "PATH/._FILE") "; that could be what you want, but it will leave a lot of files scattered around.") (p "Here, the attributes of " (tt "/Users/me/myfile") " would be written in AppleDouble v2 format to " (tt "/._./Users/me/._myfile") "."))) (section 3 "License" (p "Copyright (c) 2010 Jim Ursetto.  All rights reserved. License: New BSD (3-clause)."))))